<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-LOTOTO Lock System Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .auth-methods {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .auth-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .locked { color: #e74c3c; }
        .unlocked { color: #27ae60; }
        .total { color: #3498db; }
        .rfid { color: #f39c12; }

        .controls-section {
            padding: 30px;
            background: white;
        }

        .controls-title {
            font-size: 1.8em;
            margin-bottom: 25px;
            color: #2c3e50;
            text-align: center;
        }

        .control-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            color: #666;
        }

        .tab-btn.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .control-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-group {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .form-group h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.3em;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .password-display {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 8px;
            padding: 12px;
            font-family: monospace;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            color: #856404;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-lock {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .btn-lock:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
            transform: translateY(-2px);
        }

        .btn-unlock {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-unlock:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-2px);
        }

        .btn-monitor {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            margin: 20px auto;
            display: block;
            max-width: 300px;
        }

        .btn-monitor:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-2px);
        }

        .whatsapp-section {
            background: #25d366;
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .whatsapp-section h3 {
            color: white;
            margin-bottom: 15px;
        }

        .whatsapp-commands {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 0.9em;
        }

        .rfid-section {
            background: #f39c12;
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .rfid-section h3 {
            color: white;
            margin-bottom: 15px;
        }

        .rfid-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .rfid-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .users-grid {
            padding: 30px;
            background: #f8f9fa;
        }

        .users-title {
            font-size: 1.8em;
            margin-bottom: 25px;
            color: #2c3e50;
            text-align: center;
        }

        .user-search {
            max-width: 400px;
            margin: 0 auto 20px;
            position: relative;
        }

        .user-search input {
            width: 100%;
            padding: 12px 40px 12px 12px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1em;
        }

        .user-search .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .user-card {
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9em;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .user-locked {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .user-unlocked {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .user-card:hover {
            transform: scale(1.05);
        }

        .response-area {
            padding: 30px;
            background: white;
        }

        .response-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .response-text {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            font-family: monospace;
            white-space: pre-wrap;
            min-height: 100px;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-online { background-color: #27ae60; }
        .status-offline { background-color: #e74c3c; }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                padding: 20px;
            }
            
            .control-form {
                grid-template-columns: 1fr;
            }

            .auth-methods {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔐 E-LOTOTO</h1>
            <p>Lock System Dashboard - PT Solusi Bangun Indonesia</p>
            <p><span class="status-indicator status-online"></span>System Status: Online</p>
            <div class="auth-methods">
                <div class="auth-badge">
                    <span>📱</span> WhatsApp (Twilio)
                </div>
                <div class="auth-badge">
                    <span>📡</span> RFID Cards
                </div>
                <div class="auth-badge">
                    <span>🌐</span> Web Dashboard
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number locked" id="lockedCount">0</div>
                <div class="stat-label">Locked Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-number unlocked" id="unlockedCount">999</div>
                <div class="stat-label">Unlocked Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-number total" id="totalCount">999</div>
                <div class="stat-label">Total Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-number rfid" id="rfidCount">4</div>
                <div class="stat-label">RFID Cards</div>
            </div>
        </div>

        <div class="controls-section">
            <h2 class="controls-title">System Controls</h2>
            
            <div class="control-tabs">
                <button class="tab-btn active" onclick="switchTab('manual')">Manual Control</button>
                <button class="tab-btn" onclick="switchTab('whatsapp')">WhatsApp</button>
                <button class="tab-btn" onclick="switchTab('rfid')">RFID</button>
            </div>

            <div id="manual-tab" class="tab-content active">
                <div class="control-form">
                    <div class="form-group">
                        <h3>🔒 Lock User</h3>
                        <div class="input-group">
                            <label for="lockUser">User Number (1-999):</label>
                            <select id="lockUser" onchange="updatePassword('lock')">
                                <option value="">Select User</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Password:</label>
                            <div class="password-display" id="lockPasswordDisplay">Select user to see password</div>
                        </div>
                        <button class="btn btn-lock" onclick="lockUser()">Lock User</button>
                    </div>

                    <div class="form-group">
                        <h3>🔓 Unlock User</h3>
                        <div class="input-group">
                            <label for="unlockUser">User Number (1-999):</label>
                            <select id="unlockUser" onchange="updatePassword('unlock')">
                                <option value="">Select User</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Password:</label>
                            <div class="password-display" id="unlockPasswordDisplay">Select user to see password</div>
                        </div>
                        <button class="btn btn-unlock" onclick="unlockUser()">Unlock User</button>
                    </div>
                </div>
                
                <button class="btn btn-monitor" onclick="monitorUsers()">🖥️ Monitor All Users</button>
            </div>

            <div id="whatsapp-tab" class="tab-content">
                <div class="whatsapp-section">
                    <h3>📱 WhatsApp Commands (via Twilio)</h3>
                    <div class="whatsapp-commands">
                        <strong>Lock a user:</strong> lock[user_number],[password]<br>
                        Example: lock1,5576<br><br>
                        
                        <strong>Unlock a user:</strong> unlock[user_number],[password]<br>
                        Example: unlock1,5576<br><br>
                        
                        <strong>Monitor status:</strong> monitor<br><br>
                        
                        <strong>Help:</strong> Send any other message for help
                    </div>
                </div>
                
                <div class="form-group">
                    <h3>📲 Send WhatsApp Test Message</h3>
                    <div class="input-group">
                        <label for="whatsappNumber">Phone Number:</label>
                        <input type="tel" id="whatsappNumber" placeholder="+1234567890">
                    </div>
                    <div class="input-group">
                        <label for="whatsappMessage">Message:</label>
                        <input type="text" id="whatsappMessage" placeholder="lock1,5576">
                    </div>
                    <button class="btn btn-monitor" onclick="sendWhatsApp()">Send Test Message</button>
                </div>
            </div>

            <div id="rfid-tab" class="tab-content">
                <div class="rfid-section">
                    <h3>📡 RFID Card Management</h3>
                    <p>Currently registered RFID cards:</p>
                    <div class="rfid-cards">
                        <div class="rfid-card">
                            <strong>Card 1</strong><br>
                            UID: 20614120189<br>
                            User: 1
                        </div>
                        <div class="rfid-card">
                            <strong>Card 2</strong><br>
                            UID: 12822424732<br>
                            User: 4
                        </div>
                        <div class="rfid-card">
                            <strong>Card 3</strong><br>
                            UID: 147126116250<br>
                            User: 5
                        </div>
                        <div class="rfid-card">
                            <strong>Card 4</strong><br>
                            UID: 513613548<br>
                            User: 10
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <h3>🆔 RFID Card Scanner</h3>
                    <div class="input-group">
                        <label>Last Scanned UID:</label>
                        <div class="password-display" id="lastRFID">No card scanned</div>
                    </div>
                    <button class="btn btn-monitor" onclick="simulateRFID()">Simulate RFID Scan</button>
                </div>
            </div>
        </div>

        <div class="users-grid">
            <h2 class="users-title">User Status Overview</h2>
            <div class="user-search">
                <input type="number" id="userSearch" placeholder="Search user number..." onkeyup="filterUsers()">
                <span class="search-icon">🔍</span>
            </div>
            <div class="user-grid" id="userGrid">
                <!-- Users will be populated here -->
            </div>
        </div>

        <div class="response-area">
            <h3 class="response-title">System Response</h3>
            <div class="response-text" id="responseText">Ready to execute commands...</div>
        </div>
    </div>

    <script>
        // User data matching ESP8266 code
        const validUserNumbers = Array.from({length: 999}, (_, i) => i + 1);
        const validPasswords = [5576, 5833, 3118, 3476, 5240, 1107, 8047, 6432, 9253, 2225, 2912, 7789, 5444, 6801, 4377, 1563, 6361, 1698, 3105, 8160, 8819, 8159, 8378, 6673, 5978, 4738, 1213, 3321, 1735, 6252, 9451, 3577, 9870, 3040, 1977, 3903, 9075, 6999, 8209, 3862, 8144, 7852, 3326, 8883, 4216, 3625, 4784, 3202, 8433, 7503, 8107, 2782, 3708, 2089, 2613, 9243, 4845, 6042, 6977, 6355, 5993, 2921, 4816, 8951, 5272, 4035, 5091, 6760, 8832, 4372, 9006, 4549, 8203, 4239, 9764, 1195, 2607, 7884, 5261, 3146, 3834, 1660, 1719, 1670, 5852, 7558, 7920, 8543, 2328, 8948, 8667, 5103, 7480, 7031, 1956, 8813, 9095, 1298, 9759, 9488, 2081, 4697, 5119, 2416, 7548, 6323, 6033, 2899, 1865, 4881, 4085, 3455, 2587, 1889, 9602, 3809, 2596, 2781, 4662, 9863, 9224, 4495, 7435, 4772, 6120, 9406, 7660, 3765, 7639, 2358, 6991, 8807, 5956, 3886, 2169, 6599, 8437, 3885, 1630, 5082, 7835, 5993, 5531, 6695, 2217, 5654, 3344, 7947, 9371, 2129, 5313, 2402, 3150, 5534, 9096, 7344, 8865, 7644, 9007, 8167, 4466, 7249, 7116, 5132, 9015, 8448, 1213, 7162, 2363, 3102, 1584, 4932, 8957, 5226, 8349, 4809, 8465, 2012, 3322, 9578, 1063, 8992, 8596, 6548, 7776, 1689, 6693, 8389, 8036, 2258, 6922, 3485, 9916, 5699, 5171, 1635, 1231, 8856, 1518, 7702, 7777, 3460, 3145, 5802, 1577, 7491, 9092, 6044, 7954, 3416, 9722, 5777, 7652, 7760, 9576, 6623, 5009, 4151, 9840, 3890, 4994, 3863, 8219, 7132, 4346, 9345, 6930, 3704, 5980, 4622, 7197, 6280, 2408, 2535, 6034, 4853, 2023, 6468, 1566, 5080, 4534, 6701, 7908, 5502, 6971, 8158, 4033, 1875, 7343, 6797, 9818, 6127, 3875, 9318, 7518, 9451, 9624, 5482, 1411, 2740, 3553, 3909, 4098, 1854, 5007, 3083, 9509, 7557, 4202, 6507, 8531, 8462, 8798, 6244, 1250, 4776, 1259, 1099, 7769, 3862, 5184, 5626, 5635, 3230, 4552, 9227, 4479, 5135, 2994, 2132, 5677, 5086, 4160, 6472, 5839, 9786, 4771, 2293, 3328, 8506, 5016, 4700, 1800, 7689, 3479, 7523, 7992, 3990, 7472, 8390, 8661, 1920, 9973, 6201, 9461, 4116, 8365, 4192, 1024, 5927, 4334, 8177, 6953, 5994, 9307, 1119, 5265, 8789, 5303, 4353, 8522, 6009, 8432, 5127, 6787, 8760, 2657, 2106, 4147, 1404, 5599, 6976, 8983, 7001, 8910, 4714, 7834, 2780, 2525, 1564, 1830, 1210, 7144, 2336, 8824, 2463, 7944, 5600, 3056, 5979, 5225, 3568, 3171, 1578, 7409, 8622, 8269, 1305, 4098, 2442, 6873, 1897, 5828, 8149, 5062, 4677, 6255, 2260, 2812, 9423, 6752, 5403, 2303, 6925, 4228, 5177, 9203, 9397, 4734, 4809, 6118, 5068, 5463, 7859, 8987, 8961, 1363, 6322, 8455, 3265, 1801, 8768, 6259, 8234, 4434, 1026, 2341, 2194, 9285, 5472, 1676, 9502, 1384, 5579, 4456, 6587, 5870, 1870, 3293, 9040, 6421, 3509, 3862, 1281, 6183, 9736, 1778, 7031, 2403, 5138, 8063, 5909, 3185, 7774, 7678, 5386, 2620, 8148, 4563, 1013, 1867, 9953, 1066, 4223, 6988, 4305, 1115, 1318, 7943, 3727, 7639, 7504, 4547, 6889, 3604, 4680, 6905, 6928, 1912, 3107, 5867, 6385, 5634, 9056, 6603, 9695, 9351, 3588, 1752, 7544, 7627, 4395, 3230, 8269, 6661, 1971, 4166, 5568, 3751, 5689, 3238, 1438, 8369, 1959, 6488, 5321, 2502, 9149, 5344, 7409, 7175, 9629, 2421, 6265, 7849, 7748, 5682, 8275, 6041, 9299, 2087, 5415, 2280, 3570, 6674, 1814, 8286, 1985, 7255, 7943, 3906, 5558, 6563, 5037, 8643, 7578, 3417, 3528, 9570, 2558, 8935, 5192, 8155, 2147, 3358, 7969, 6016, 6813, 7348, 8776, 4882, 9954, 9374, 7962, 5974, 4613, 7983, 5044, 1452, 8089, 7190, 8105, 5201, 6081, 9604, 4984, 8882, 3107, 7993, 6955, 3458, 6954, 8795, 7876, 4848, 1818, 8532, 2624, 8067, 8672, 9030, 7003, 7883, 3905, 1330, 4138, 4117, 6110, 6383, 8842, 8282, 5741, 8116, 2371, 8782, 8288, 8999, 1031, 5880, 1974, 5546, 7747, 1315, 5391, 4897, 4427, 6134, 1505, 5050, 6341, 4653, 3800, 7476, 5865, 6087, 6053, 1047, 8689, 7816, 2778, 8327, 4650, 5957, 9428, 6681, 7408, 1803, 3067, 4675, 4628, 7055, 6106, 2258, 7133, 3100, 2638, 7526, 3800, 1132, 3576, 3675, 4127, 4219, 1594, 5866, 1015, 3258, 6337, 6001, 4434, 5456, 7741, 1984, 3948, 4089, 4025, 7403, 6716, 3793, 9799, 2010, 5674, 7639, 6701, 7768, 8203, 1450, 9958, 3224, 1578, 6651, 7149, 4719, 4436, 7960, 3654, 7264, 5797, 2068, 6463, 3622, 2828, 3880, 7834, 3662, 8439, 6018, 1877, 9823, 1002, 9973, 1344, 8756, 3554, 6008, 5989, 1501, 3065, 6846, 1217, 3227, 2438, 6340, 6452, 6903, 8095, 5940, 9026, 4045, 1760, 4084, 1770, 1386, 3873, 9916, 3681, 6442, 7241, 1418, 3244, 7978, 2626, 4410, 3881, 4832, 4520, 2713, 5917, 6939, 1834, 7557, 8200, 6257, 5881, 9646, 9901, 9993, 5470, 5254,
